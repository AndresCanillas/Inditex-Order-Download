@page
@inject ILocalizationService g
@{
	Layout = null;
}
//# sourceURL=https://Pages/OrderPool/Upload.js
/// <reference path="/js/jquery-3.0.0.min.js" />
/// <reference path="/js/Kendo.all.min.js" />
/// <reference path="/js/AppContext.js" />

//<script>
	var OrderPoolUpload = function (title) {
		FormView.Extend(this, title, "/OrderPool/Upload");
	};


	OrderPoolUpload.prototype = {
		constructor: OrderPoolUpload,

		OnLoad: function () {
			var self = this;
			this.elements.files.kendoUpload({
				async: {
					saveUrl: `/orderpool/upload`,
					autoUpload: true
				},
				multiple: false,
				success: function (e) {
					if (!e.response.Success) {
						e.preventDefault();
						AppContext.ShowError(e.response.Message);
					}
					else {
						  AppContext.ShowSuccess("@g["File was uploaded."]");
					}
				},
                error: function (config) {
                    try {
                        var operationResult = JSON.parse(config.XMLHttpRequest.responseText);
                        AppContext.ShowError("@g["Error uploading file"] " + operationResult.message);
                    } finally {

                    }
                },
				localization: {
					select: '@g["Select File"]',
					remove: '@g["Remove"]',
					cancel: '@g["Cancel"]',
					headerStatusUploading: "@g["Uploading..."]",
					headerStatusUploaded: "@g["Done"]"
				}
			});
		}
	};
//</script>