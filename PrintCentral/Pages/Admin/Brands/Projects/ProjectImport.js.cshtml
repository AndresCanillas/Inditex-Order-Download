@page
@inject ILocalizationService g
@{
    Layout = null;
}
//# sourceURL=https://Pages/Admin/Brands/Projects/ProjectImport.js
/// <reference path="/js/jquery-3.0.0.min.js" />
/// <reference path="/js/Kendo.all.min.js" />
/// <reference path="/js/AppContext.js" />

//<script>
    var ProjectImport = function (title, brandId, proyectId) {
        FormView.Extend(this, title, "/Admin/Brands/Projects/ProjectImport");
        this.BrandId = brandId;
        this.ProyectId = proyectId;
	};

    ProjectImport.prototype = {
        constructor: ProjectImport,

		OnLoad: function () {
			var self = this;
			this.elements.files.kendoUpload({
                async: {
                    saveUrl: `/projects/import/${self.BrandId}/${self.ProyectId}`,
					autoUpload: true
				},
				multiple: false,
				success: function (e) {
					if (!e.response.Success) {
						e.preventDefault();
						AppContext.ShowError(e.response.message);
					}
					else {
						self.FileUploaded();
					}
				},
				error: function () { AppContext.ShowError("@g["Error uploading file"]"); },
				localization: {
					select: '@g["Select File"]',
					remove: '@g["Remove"]',
					cancel: '@g["Cancel"]',
					headerStatusUploading: "@g["Uploading..."]",
					headerStatusUploaded: "@g["Done"]"
				}
			});
		},

		FileUploaded: function () {
            this.Close();
            AppContext.ShowSuccess("Project Imported.");
        }
	};
//</script>