@page
@inject RequestLocalizationOptions langOptions
@inject ILocalizationService g
@inject INotificationRepository notifications
@inject ICompanyRepository companyRepo
@inject IProjectRepository projectRepo
@inject IBrandRepository brandRepo
@inject IFactory factory
@inject IAppConfig config
@{
    Layout = null;
    var showToggleButton = Request.Query["t"] == "1";
    var notificationCount = notifications.GetNotificationCount();
    var company = companyRepo.GetSelectedCompany();
    var project = projectRepo.GetSelectedProject();
    var brand = brandRepo.GetSelectedBrand();
    var s = User.Identity.Name;
    var usrName = s.Length < 12 ? s : s.Substring(0, 12);
    bool isqa = config.GetValue("WebLink.IsQA", false);
    var userData = factory.GetInstance<IUserData>();
    var classQA = isqa ? "#10b145" : "#3F454A";
}
	<nav class="navbar navbar-expand-lg navbar-dark" style="position:fixed; top:0px; left:0px; z-index:10; width:100%; background-color:@classQA; color:#ffffff; border-bottom:solid 1px #000000;">
		@if (showToggleButton)
		{
			<img action="ToggleMenu" src="/images/tree2_30.png" style="position: relative; top:2px; margin-right:15px; padding:7px 15px 7px 15px; cursor:pointer; border:1px solid #53585C; border-radius:4px;" />
		}
		<a href="/">
		<div style="white-space:nowrap">
			<img src="/images/LOGO_IDT_BY_INDET_GROUP.png" width="140" height="12" />
			@if (isqa)
			{
				<span style="-webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; font-family:Calibri; font-size:7pt; color:white">QA</span>
			}
		</div>
		</a>
		@if (userData.CanSelectBrandProject)
		{
			<a class="brand-project-link" href="#" action="ProjectSelection">
				@company.Name  / @brand.Name / @project.Name
			</a>
		}
		else
		{
			<p class="brand-project-link">&nbsp;</p>
		}
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarNavAltMarkup" style="max-width:450px;">
			<ul class="navbar-nav ml-auto">
				<li class="nav-item" style="flex: 0 0 auto;">
					<a class="nav-link" href="#" action="ShowNotifications">
						@if (notificationCount > 0 && notificationCount < 100)
						{
							@:<span class="fa fa-bell"></span>&nbsp;@g["Notifications"] <span name="NotificationCount" class="numberCircle">@notificationCount</span>
						}
						else if (notificationCount > 100)
						{
							@:<span class="fa fa-bell"></span>&nbsp;@g["Notifications"] <span name="NotificationCount" class="numberCircle">99+</span>
						}
						else
						{
							@:<span class="fa fa-bell"></span>&nbsp;@g["Notifications"] <span name="NotificationCount" class="numberCircle" style="display:none"></span>
						}
					</a>
				</li>
				<li class="nav-item dropdown" style="flex: 0 0 auto;">
					<a class="nav-link dropdown-toggle" style="width:150px; text-align:center; padding-left:10px; cursor:pointer;" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						&nbsp;@g["Language"]
					</a>
					<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown2">
						<!--
						NOTE: The following declarations trick the ResourceGen tool to generate resources for supported languages:
						g["English (United States)"]
						g["Spanish (Spain, International Sort)"]
						g["French (France)"]
						g["Portuguese (Brazil)"]
						g["Catalán (Cataluña)"]
						g["Turkish (Turkey)"]
						-->
						@foreach (var culture in langOptions.SupportedUICultures)
						{
							<a class="dropdown-item" href="/Account/Lang/@culture.Name"><span class="fa fa-flag"></span>&nbsp;@g[culture.DisplayName]</a>
						}
					</div>
				</li>
				<li class="nav-item dropdown" style="flex: 0 0 auto;">
					<a class="nav-link dropdown-toggle" style="padding-left:10px; cursor:pointer; max-width:280px;" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<span class="fa fa-user"></span>&nbsp;@usrName
					</a>
					<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
						<a class="dropdown-item" href="#" action="UserProfile"><span class="fa fa-address-card"></span>&nbsp;@g["Profile"]</a>
						@if (userData.CanSeeMainAdminMenu)
						{
							<a class="dropdown-item" href="/admin"><span class="fa fa-cog"></span>&nbsp;@g["Administration"]</a>
						}
						@if (userData.CanSelectCompany)
						{
							<a class="dropdown-item" href="#" action="CompanySelection"><span class="fa fa-building"></span>&nbsp;@g["Select Company"]</a>
						}
						<div class="dropdown-divider"></div>
						<a class="dropdown-item" href="/Account/Logout"><span class="fa fa-power-off"></span>&nbsp;@g["Logout"]</a>
					</div>
				</li>
			</ul>
		</div>
	</nav>
